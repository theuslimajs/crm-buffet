generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

//////////////////////////////////////////////////////
// ENUMS (OBRIGATORIAMENTE MULTILINHA NO PRISMA)
//////////////////////////////////////////////////////

enum CargoUsuario {
  DONO
  GERENTE
  VENDEDOR
  FREELANCER
}

enum StatusLead {
  NOVO
  EM_NEGOCIACAO
  FECHADO
  PERDIDO
}

enum StatusFesta {
  AGENDADO
  REALIZADO
  CANCELADO
}

enum StatusTarefa {
  PENDENTE
  CONCLUIDA
}

enum StatusPagamento {
  PENDENTE
  PAGO
}

enum MetodoPagamento {
  PIX
  CARTAO
  DINHEIRO
  A_DEFINIR
  A_RECEBER
}

//////////////////////////////////////////////////////
// 1. USU√ÅRIOS
//////////////////////////////////////////////////////

model Usuario {
  id                String   @id @default(uuid())
  nome              String
  email             String   @unique
  senha             String
  cargo             CargoUsuario
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  podeVerLeads      Boolean  @default(false)
  podeVerCalendario Boolean  @default(false)
  podeVerFestas     Boolean  @default(false)
  podeVerTarefas    Boolean  @default(false)
  podeVerEstoque    Boolean  @default(false)
  podeVerFinanceiro Boolean  @default(false)
  podeVerRelatorios Boolean  @default(false)
}

//////////////////////////////////////////////////////
// 2. CRM
//////////////////////////////////////////////////////

model Lead {
  id         String     @id @default(uuid())
  nome       String
  telefone   String
  status     StatusLead @default(NOVO)
  origem     String?
  dataVisita DateTime?
  createdAt  DateTime   @default(now())
}

model Cliente {
  id        String   @id @default(uuid())
  nome      String
  telefone  String
  email     String?
  createdAt DateTime @default(now())

  festas    Festa[]
}

//////////////////////////////////////////////////////
// 3. FESTAS
//////////////////////////////////////////////////////

model Festa {
  id                 String       @id @default(uuid())
  nomeAniversariante String
  dataFesta          DateTime
  horaInicio         String       @default("19:00")
  horaFim            String       @default("23:00")
  valorTotal         Float
  qtdPessoas         Int
  status             StatusFesta  @default(AGENDADO)
  createdAt          DateTime     @default(now())

  clienteId String
  cliente   Cliente   @relation(fields: [clienteId], references: [id])

  pacoteId  String?
  pacote    Pacote?   @relation(fields: [pacoteId], references: [id])

  pagamentos Pagamento[]
}

model Pacote {
  id        String  @id @default(uuid())
  nome      String
  precoBase Float
  descricao String?

  festas    Festa[]
}

//////////////////////////////////////////////////////
// 4. TAREFAS
//////////////////////////////////////////////////////

model Tarefa {
  id         String        @id @default(uuid())
  descricao  String
  equipe     String
  dataLimite DateTime
  status     StatusTarefa  @default(PENDENTE)
  createdAt  DateTime      @default(now())
}

//////////////////////////////////////////////////////
// 5. ESTOQUE
//////////////////////////////////////////////////////

model ItemEstoque {
  id            String   @id @default(uuid())
  nome          String
  categoria     String
  quantidade    Int
  estoqueMinimo Int
  unidade       String   @default("UN")
  updatedAt     DateTime @updatedAt
}

//////////////////////////////////////////////////////
// 6. FINANCEIRO
//////////////////////////////////////////////////////

model Pagamento {
  id             String           @id @default(uuid())
  valor          Float
  dataVencimento DateTime
  status         StatusPagamento  @default(PENDENTE)
  parcela        Int
  metodo         MetodoPagamento  @default(A_DEFINIR)
  createdAt      DateTime         @default(now())

  festaId String?
  festa   Festa? @relation(fields: [festaId], references: [id])
}

model Despesa {
  id             String   @id @default(uuid())
  descricao      String
  valor          Float
  categoria      String?
  dataVencimento DateTime
  status         StatusPagamento @default(PENDENTE)
  createdAt      DateTime @default(now())
}

//////////////////////////////////////////////////////
// 7. SIMULADOR
//////////////////////////////////////////////////////

model Simulacao {
  id              String   @id @default(uuid())
  festaId         String?
  receitaPrevista Float
  custoTotal      Float
  lucroEstimado   Float
  margem          Float
  detalhes        String
  createdAt       DateTime @default(now())
}
